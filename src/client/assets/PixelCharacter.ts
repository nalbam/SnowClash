/**
 * 32x32 Pixel Art Character Generator for SnowClash
 * 레밍즈 스타일 귀여운 캐릭터 - Red/Blue 팀 지원
 * 특징: 큰 머리(2등신), 팀 색상 머리카락, 작은 몸
 */

// 색상 팔레트
const PALETTE = {
  // 공통
  TRANSPARENT: null,
  WHITE: 0xFFFFFF,
  SKIN_LIGHT: 0xFFE4C4,
  SKIN_SHADOW: 0xE8C8A8,
  BLACK: 0x000000,
  BROWN: 0x8B4513,
  PINK: 0xFFB6C1,

  // Red 팀 (머리카락)
  RED_MAIN: 0xE53935,
  RED_DARK: 0xB71C1C,
  RED_LIGHT: 0xFF6659,

  // Blue 팀 (머리카락)
  BLUE_MAIN: 0x1E88E5,
  BLUE_DARK: 0x0D47A1,
  BLUE_LIGHT: 0x6AB7FF,

  // 옷 - Red 팀 (연한 빨강/핑크 계열)
  RED_CLOTH_MAIN: 0xFFB4B4,
  RED_CLOTH_SHADOW: 0xE89999,

  // 옷 - Blue 팀 (연한 파랑 계열)
  BLUE_CLOTH_MAIN: 0xB4D4FF,
  BLUE_CLOTH_SHADOW: 0x99BBE8,

  // 스턴 상태
  STUN_OVERLAY: 0x666666,
};

// 픽셀 데이터 (32x32)
// 0: 투명, 1: 살색밝음, 2: 살색그림자, 3: 검정(눈동자), 4: 팀색상, 5: 팀어두움, 6: 팀밝음
// 7: 흰색(눈흰자), 8: 갈색(신발), 9: 핑크(볼), A: 옷메인, B: 옷그림자

// IDLE - 기본 서있는 자세
const CHARACTER_IDLE = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111177311177311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '0000000000AAAAAAAAAAA0000000000',
  '000000000AAAAAAAAAAAAA000000000',
  '000000000AAAAABBBAAAAAA00000000',
  '000000000AAAAABBBAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// WALK1 - 걷기 1 (왼발 앞)
const CHARACTER_WALK1 = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111177311177311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '0000000000AAAAAAAAAAA0000000000',
  '000000000AAAAAAAAAAAAA000000000',
  '000000000AAAAABBBAAAAAA00000000',
  '000000000AAAAABBBAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000001110001110000000000',
  '000000000011100001110000000000',
  '000000000111000000111000000000',
  '000000000888000000088000000000',
  '000000008880000000088800000000',
  '00000000000000000000000000000000',
];

// WALK2 - 걷기 2 (중립)
const CHARACTER_WALK2 = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111177311177311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '0000000000AAAAAAAAAAA0000000000',
  '000000000AAAAAAAAAAAAA000000000',
  '000000000AAAAABBBAAAAAA00000000',
  '000000000AAAAABBBAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// WALK3 - 걷기 3 (오른발 앞)
const CHARACTER_WALK3 = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111177311177311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '0000000000AAAAAAAAAAA0000000000',
  '000000000AAAAAAAAAAAAA000000000',
  '000000000AAAAABBBAAAAAA00000000',
  '000000000AAAAABBBAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000001110001110000000000',
  '000000000001110000111000000000',
  '000000000001110000011100000000',
  '000000000008800000008880000000',
  '000000000008880000000888000000',
  '00000000000000000000000000000000',
];

// WALK4 - 걷기 4 (중립 복귀)
const CHARACTER_WALK4 = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111177311177311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '0000000000AAAAAAAAAAA0000000000',
  '000000000AAAAAAAAAAAAA000000000',
  '000000000AAAAABBBAAAAAA00000000',
  '000000000AAAAABBBAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// CHEER1 - 만세 1 (양팔 위로)
const CHARACTER_CHEER1 = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111173311173311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111119999111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '00011100000AAAAAAAA0000001110000',
  '00111100AAAAAAAAAAAAA000111100',
  '00111100AAAAABBBAAAAAA00111100',
  '00011100AAAAABBBAAAAAA00011100',
  '00000000AAAAAAAAAAAAA0000000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// CHEER2 - 만세 2 (양팔 더 위로)
const CHARACTER_CHEER2 = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111173311173311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111119999111111440000000',
  '00000044111111111111111440000000',
  '00111104411111111111114401111000',
  '01111100441111111111144001111100',
  '01111100000AAAAAAAA0000001111100',
  '00111100AAAAAAAAAAAAA000011110',
  '000000AAAAABBBBBAAAAAA00000000',
  '000000AAAAABBBBBAAAAAA00000000',
  '0000000000AAAAAAAAAAA0000000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// THROW_PREPARE - 던지기 준비 (눈덩이 들고)
const CHARACTER_THROW_PREPARE = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111177311177311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '0000000000AAAAAAAAAAA0001110000',
  '000000000AAAAAAAAAAAAA001777100',
  '000000000AAAAABBBAAAAAA01777710',
  '000000000AAAAABBBAAAAAA00177100',
  '0000000000AAAAAAAAAAAAA00011000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// THROW - 던지는 중 (팔 뻗음)
const CHARACTER_THROW = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111111111111111440000000',
  '00000044111133311133311440000000',
  '00000044111133311133311440000000',
  '00000044111111111111111440000000',
  '00000044119111111111911440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00111100441111111111144000000000',
  '0111110000AAAAAAAAAAA0000000000',
  '011111AAAAAAAAAAAAAAAA000000000',
  '001110AAAAAAABBBAAAAAA000000000',
  '000000AAAAAAABBBAAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// THROW_FOLLOW - 던진 후 자세
const CHARACTER_THROW_FOLLOW = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111177711177711440000000',
  '00000044111177311177311440000000',
  '00000044111177711177711440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111113333111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '01111100441111111111144000000000',
  '1111110000AAAAAAAAAAA0000000000',
  '111111AAAAAAAAAAAAAAAA000000000',
  '011110AAAAAAABBBAAAAAA000000000',
  '001100AAAAAAABBBAAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

// STUNNED - 스턴 상태 (X_X 눈)
const CHARACTER_STUNNED = [
  '00000000000000000000000000000000',
  '00000000000006666600000000000000',
  '00000000000666666666000000000000',
  '00000000006666666666600000000000',
  '00000000066655555556660000000000',
  '00000000666644444446666000000000',
  '00000006666444444444666600000000',
  '00000066664444444444466660000000',
  '00000066644111111114466660000000',
  '00000066441111111111144660000000',
  '00000064411111111111114460000000',
  '00000044111131311131311440000000',
  '00000044111113111113111440000000',
  '00000044111131311131311440000000',
  '00000044119111111111911440000000',
  '00000044111111111111111440000000',
  '00000044111119999111111440000000',
  '00000044111111111111111440000000',
  '00000004411111111111114400000000',
  '00000000441111111111144000000000',
  '0000000000AAAAAAAAAAA0000000000',
  '000000000AAAAAAAAAAAAA000000000',
  '000000000AAAAABBBAAAAAA00000000',
  '000000000AAAAABBBAAAAAA00000000',
  '0000000000AAAAAAAAAAAAA00000000',
  '00000000000AAAAAAAAAAA000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000011101110000000000',
  '000000000000088808880000000000',
  '000000000000088808880000000000',
  '00000000000000000000000000000000',
];

export type CharacterState = 'idle' | 'walk1' | 'walk2' | 'walk3' | 'walk4' | 'throw_prepare' | 'throw' | 'throw_follow' | 'stunned' | 'cheer1' | 'cheer2';
export type TeamColor = 'red' | 'blue';

const FRAMES: Record<CharacterState, string[]> = {
  idle: CHARACTER_IDLE,
  walk1: CHARACTER_WALK1,
  walk2: CHARACTER_WALK2,
  walk3: CHARACTER_WALK3,
  walk4: CHARACTER_WALK4,
  throw_prepare: CHARACTER_THROW_PREPARE,
  throw: CHARACTER_THROW,
  throw_follow: CHARACTER_THROW_FOLLOW,
  stunned: CHARACTER_STUNNED,
  cheer1: CHARACTER_CHEER1,
  cheer2: CHARACTER_CHEER2,
};

/**
 * Phaser Scene에서 픽셀 캐릭터 텍스처 생성
 */
export function generateCharacterTextures(scene: Phaser.Scene): void {
  const teams: TeamColor[] = ['red', 'blue'];
  const states: CharacterState[] = ['idle', 'walk1', 'walk2', 'walk3', 'walk4', 'throw_prepare', 'throw', 'throw_follow', 'stunned', 'cheer1', 'cheer2'];

  teams.forEach(team => {
    states.forEach(state => {
      const key = `character_${team}_${state}`;
      if (scene.textures.exists(key)) return;

      const graphics = scene.make.graphics({ x: 0, y: 0 });
      drawCharacter(graphics, FRAMES[state], team, state === 'stunned');
      graphics.generateTexture(key, 32, 32);
      graphics.destroy();
    });
  });

  // 눈덩이 텍스처도 생성
  generateSnowballTextures(scene);
}

function drawCharacter(
  graphics: Phaser.GameObjects.Graphics,
  pixelData: string[],
  team: TeamColor,
  isStunned: boolean
): void {
  const teamColors = team === 'red'
    ? { main: PALETTE.RED_MAIN, dark: PALETTE.RED_DARK, light: PALETTE.RED_LIGHT,
        clothMain: PALETTE.RED_CLOTH_MAIN, clothShadow: PALETTE.RED_CLOTH_SHADOW }
    : { main: PALETTE.BLUE_MAIN, dark: PALETTE.BLUE_DARK, light: PALETTE.BLUE_LIGHT,
        clothMain: PALETTE.BLUE_CLOTH_MAIN, clothShadow: PALETTE.BLUE_CLOTH_SHADOW };

  for (let y = 0; y < 32; y++) {
    const row = pixelData[y];
    for (let x = 0; x < 32; x++) {
      const pixel = row[x];
      let color: number | null = null;

      switch (pixel) {
        case '0': color = null; break; // 투명
        case '1': color = PALETTE.SKIN_LIGHT; break; // 살색 밝음
        case '2': color = PALETTE.SKIN_SHADOW; break; // 살색 그림자
        case '3': color = PALETTE.BLACK; break; // 검정 (눈동자, 입)
        case '4': color = teamColors.main; break; // 팀 메인 색상 (머리카락)
        case '5': color = teamColors.dark; break; // 팀 어두운 색상
        case '6': color = teamColors.light; break; // 팀 밝은 색상
        case '7': color = PALETTE.WHITE; break; // 흰색 (눈 흰자)
        case '8': color = PALETTE.BROWN; break; // 갈색 (신발)
        case '9': color = PALETTE.PINK; break; // 핑크 (볼, 입술)
        case 'A': color = teamColors.clothMain; break; // 옷 메인 (팀 색상)
        case 'B': color = teamColors.clothShadow; break; // 옷 그림자 (팀 색상)
      }

      if (color !== null) {
        if (isStunned) {
          // 스턴 상태: 회색조로 변환
          color = blendWithGray(color, 0.5);
        }
        graphics.fillStyle(color, 1);
        graphics.fillRect(x, y, 1, 1);
      }
    }
  }
}

function blendWithGray(color: number, amount: number): number {
  const r = (color >> 16) & 0xFF;
  const g = (color >> 8) & 0xFF;
  const b = color & 0xFF;

  const gray = Math.round((r + g + b) / 3);

  const newR = Math.round(r + (gray - r) * amount);
  const newG = Math.round(g + (gray - g) * amount);
  const newB = Math.round(b + (gray - b) * amount);

  return (newR << 16) | (newG << 8) | newB;
}

/**
 * 눈덩이 픽셀아트 텍스처 생성
 */
function generateSnowballTextures(scene: Phaser.Scene): void {
  // 일반 눈덩이 (10x10)
  const normalKey = 'snowball_normal';
  if (!scene.textures.exists(normalKey)) {
    const g = scene.make.graphics({ x: 0, y: 0 });
    drawSnowball(g, 10, false);
    g.generateTexture(normalKey, 10, 10);
    g.destroy();
  }

  // 차징 눈덩이 (18x18)
  const chargedKey = 'snowball_charged';
  if (!scene.textures.exists(chargedKey)) {
    const g = scene.make.graphics({ x: 0, y: 0 });
    drawSnowball(g, 18, true);
    g.generateTexture(chargedKey, 18, 18);
    g.destroy();
  }

  // 팀 색상 눈덩이
  ['red', 'blue'].forEach(team => {
    const color = team === 'red' ? PALETTE.RED_LIGHT : PALETTE.BLUE_LIGHT;

    const normalTeamKey = `snowball_${team}_normal`;
    if (!scene.textures.exists(normalTeamKey)) {
      const g = scene.make.graphics({ x: 0, y: 0 });
      drawColoredSnowball(g, 10, color);
      g.generateTexture(normalTeamKey, 10, 10);
      g.destroy();
    }

    const chargedTeamKey = `snowball_${team}_charged`;
    if (!scene.textures.exists(chargedTeamKey)) {
      const g = scene.make.graphics({ x: 0, y: 0 });
      drawColoredSnowball(g, 18, color);
      g.generateTexture(chargedTeamKey, 18, 18);
      g.destroy();
    }
  });
}

function drawSnowball(graphics: Phaser.GameObjects.Graphics, size: number, charged: boolean): void {
  const center = size / 2;
  const radius = size / 2 - 1;

  // 그림자
  graphics.fillStyle(0xCCCCCC, 0.5);
  graphics.fillCircle(center + 1, center + 1, radius);

  // 메인 눈덩이
  graphics.fillStyle(0xFFFFFF, 1);
  graphics.fillCircle(center, center, radius);

  // 하이라이트
  graphics.fillStyle(0xFFFFFF, 1);
  graphics.fillCircle(center - radius / 3, center - radius / 3, radius / 4);

  if (charged) {
    // 차징 눈덩이는 테두리 추가
    graphics.lineStyle(2, 0xADD8E6, 1);
    graphics.strokeCircle(center, center, radius);
  }
}

function drawColoredSnowball(graphics: Phaser.GameObjects.Graphics, size: number, color: number): void {
  const center = size / 2;
  const radius = size / 2 - 1;

  // 그림자
  graphics.fillStyle(0x888888, 0.3);
  graphics.fillCircle(center + 1, center + 1, radius);

  // 메인 눈덩이 (팀 색상)
  graphics.fillStyle(color, 0.9);
  graphics.fillCircle(center, center, radius);

  // 흰색 코어
  graphics.fillStyle(0xFFFFFF, 0.7);
  graphics.fillCircle(center, center, radius * 0.6);

  // 하이라이트
  graphics.fillStyle(0xFFFFFF, 1);
  graphics.fillCircle(center - radius / 3, center - radius / 3, radius / 4);
}

/**
 * 캐릭터 애니메이션 생성
 */
export function createCharacterAnimations(scene: Phaser.Scene): void {
  const teams: TeamColor[] = ['red', 'blue'];

  teams.forEach(team => {
    // 걷기 애니메이션 (4프레임)
    const walkKey = `${team}_walk`;
    if (!scene.anims.exists(walkKey)) {
      scene.anims.create({
        key: walkKey,
        frames: [
          { key: `character_${team}_walk1` },
          { key: `character_${team}_walk3` },
          { key: `character_${team}_walk2` },
          { key: `character_${team}_walk4` },
        ],
        frameRate: 8,
        repeat: -1
      });
    }

    // 대기 애니메이션
    const idleKey = `${team}_idle`;
    if (!scene.anims.exists(idleKey)) {
      scene.anims.create({
        key: idleKey,
        frames: [{ key: `character_${team}_idle` }],
        frameRate: 1,
        repeat: -1
      });
    }

    // 던지기 애니메이션 (3단계)
    const throwKey = `${team}_throw`;
    if (!scene.anims.exists(throwKey)) {
      scene.anims.create({
        key: throwKey,
        frames: [
          { key: `character_${team}_throw_prepare` },
          { key: `character_${team}_throw` },
          { key: `character_${team}_throw_follow` },
          { key: `character_${team}_idle` },
        ],
        frameRate: 10,
        repeat: 0
      });
    }

    // 만세 애니메이션 (2프레임)
    const cheerKey = `${team}_cheer`;
    if (!scene.anims.exists(cheerKey)) {
      scene.anims.create({
        key: cheerKey,
        frames: [
          { key: `character_${team}_cheer1` },
          { key: `character_${team}_cheer2` },
        ],
        frameRate: 4,
        repeat: -1
      });
    }

    // 스턴 애니메이션
    const stunnedKey = `${team}_stunned`;
    if (!scene.anims.exists(stunnedKey)) {
      scene.anims.create({
        key: stunnedKey,
        frames: [{ key: `character_${team}_stunned` }],
        frameRate: 1,
        repeat: -1
      });
    }
  });
}
