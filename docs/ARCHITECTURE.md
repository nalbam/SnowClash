# ì•„í‚¤í…ì²˜ ê°€ì´ë“œ

SnowClashì˜ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ì™€ ê° ì»´í¬ë„ŒíŠ¸ì˜ ì—­í• ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

**ê´€ë ¨ ë¬¸ì„œ:**
- [API Reference](./API.md) - REST API ë° WebSocket ë©”ì‹œì§€ í”„ë¡œí† ì½œ
- [Game Mechanics](./GAME_MECHANICS.md) - ê²Œì„ ë¡œì§ ë° ê·œì¹™
- [Testing Guide](./TESTING.md) - í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ì»¤ë²„ë¦¬ì§€

---

## ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨](#ì•„í‚¤í…ì²˜-ë‹¤ì´ì–´ê·¸ë¨)
3. [ì„œë²„ ì•„í‚¤í…ì²˜](#ì„œë²„-ì•„í‚¤í…ì²˜)
4. [í´ë¼ì´ì–¸íŠ¸ ì•„í‚¤í…ì²˜](#í´ë¼ì´ì–¸íŠ¸-ì•„í‚¤í…ì²˜)
5. [ì¢Œí‘œ ë³€í™˜ ì‹œìŠ¤í…œ](#ì¢Œí‘œ-ë³€í™˜-ì‹œìŠ¤í…œ)
6. [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)
7. [ë””ë ‰í† ë¦¬ êµ¬ì¡°](#ë””ë ‰í† ë¦¬-êµ¬ì¡°)

---

## ì‹œìŠ¤í…œ ê°œìš”

SnowClashëŠ” 3v3 ë©€í‹°í”Œë ˆì´ì–´ ëˆˆì‹¸ì›€ ê²Œì„ìœ¼ë¡œ, ë‹¤ìŒ ê¸°ìˆ  ìŠ¤íƒì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

| êµ¬ì„±ìš”ì†Œ | ê¸°ìˆ  | ì—­í•  |
|---------|------|------|
| ì„œë²„ | Express + Colyseus | HTTP ì„œë²„, ê²Œì„ ìƒíƒœ ê´€ë¦¬, WebSocket í†µì‹  |
| í´ë¼ì´ì–¸íŠ¸ | Phaser 3 | ê²Œì„ ë Œë”ë§, ì…ë ¥ ì²˜ë¦¬, UI |
| ìƒíƒœ ë™ê¸°í™” | @colyseus/schema | ì„œë²„-í´ë¼ì´ì–¸íŠ¸ ê°„ ì‹¤ì‹œê°„ ìƒíƒœ ë™ê¸°í™” |
| ë¹Œë“œ | TypeScript + Webpack | íƒ€ì… ì•ˆì „ì„±, ëª¨ë“ˆ ë²ˆë“¤ë§ |

---

## ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         í´ë¼ì´ì–¸íŠ¸ (Phaser 3)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  MainMenuScene   â”‚â”€â†’â”‚   LobbyScene     â”‚â”€â†’â”‚   GameScene      â”‚â”‚
â”‚  â”‚  - ë‹‰ë„¤ì„ ì„¤ì •    â”‚  â”‚  - íŒ€ ì„ íƒ       â”‚  â”‚  - ê²Œì„ ë Œë”ë§    â”‚â”‚
â”‚  â”‚  - ë£¸ ëª©ë¡       â”‚  â”‚  - Ready ì‹œìŠ¤í…œ   â”‚  â”‚  - ì…ë ¥ ì²˜ë¦¬      â”‚â”‚
â”‚  â”‚  - ë£¸ ìƒì„±/ì°¸ì—¬   â”‚  â”‚  - í˜¸ìŠ¤íŠ¸ ê¶Œí•œ    â”‚  â”‚  - ìƒíƒœ ë°˜ì˜      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚           â”‚                     â”‚                     â”‚          â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                 â”‚                                â”‚
â”‚                    WebSocket (colyseus.js)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ ws://localhost:2567
                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â–¼                                â”‚
â”‚                          ì„œë²„ (Colyseus)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                       GameRoom                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚  â”‚  â”‚ onCreate    â”‚  â”‚ onMessage   â”‚  â”‚ updateGame  â”‚        â”‚  â”‚
â”‚  â”‚  â”‚ ìƒíƒœ ì´ˆê¸°í™”  â”‚  â”‚ ë©”ì‹œì§€ ì²˜ë¦¬  â”‚  â”‚ ê²Œì„ ë£¨í”„    â”‚        â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚                   GameState                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - players: MapSchema<PlayerSchema>                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - snowballs: MapSchema<SnowballSchema>              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - phase: 'lobby' | 'playing' | 'ended'              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - roomName, botCount                                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚                  BotController                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - ë´‡ ìƒì„±/ì œê±°                                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - ë´‡ í–‰ë™ (2ì´ˆë§ˆë‹¤ ëˆˆë©ì´ ë°œì‚¬)                       â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    REST API (Express)                      â”‚  â”‚
â”‚  â”‚  GET /api/rooms - ë£¸ ëª©ë¡ ì¡°íšŒ                             â”‚  â”‚
â”‚  â”‚  POST /api/rooms - ë£¸ ìƒì„±                                 â”‚  â”‚
â”‚  â”‚  GET /api/nickname - ëœë¤ ë‹‰ë„¤ì„ ìƒì„±                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚                    Express (ì •ì  íŒŒì¼ ì„œë¹™)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì„œë²„ ì•„í‚¤í…ì²˜

### ì§„ì…ì  (`src/server/index.ts`)

ì„œë²„ ì‹œì‘ì ìœ¼ë¡œ Expressì™€ Colyseusë¥¼ í†µí•©í•©ë‹ˆë‹¤.

```typescript
// Express ì•± ì„¤ì •
const app = express();
app.use(cors());
app.use(express.static('public'));  // í´ë¼ì´ì–¸íŠ¸ ë²ˆë“¤ ì„œë¹™

// REST API ì—”ë“œí¬ì¸íŠ¸
app.get('/api/rooms', ...);      // ë£¸ ëª©ë¡ ì¡°íšŒ
app.post('/api/rooms', ...);     // ë£¸ ìƒì„±
app.get('/api/nickname', ...);   // ëœë¤ ë‹‰ë„¤ì„ ìƒì„±

// Colyseus ê²Œì„ ì„œë²„ ìƒì„±
const server = createServer(app);
const gameServer = new Server({ server });

// GameRoom ë“±ë¡
gameServer.define('game_room', GameRoom);

// í¬íŠ¸ 2567ì—ì„œ ì‹œì‘ (í™˜ê²½ë³€ìˆ˜ë¡œ ë³€ê²½ ê°€ëŠ¥)
gameServer.listen(Number(process.env.PORT) || 2567);
```

### ê²Œì„ ë£¸ (`src/server/rooms/GameRoom.ts`)

ëª¨ë“  ê²Œì„ ë¡œì§ì´ ì§‘ì¤‘ëœ í•µì‹¬ íŒŒì¼ì…ë‹ˆë‹¤.

#### Room ë¼ì´í”„ì‚¬ì´í´

| ë©”ì„œë“œ | ì‹œì  | ì—­í•  |
|--------|------|------|
| `onCreate` | ë°© ìƒì„± ì‹œ | ìƒíƒœ ì´ˆê¸°í™”, ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ ë“±ë¡, BotController ìƒì„± |
| `onJoin` | í”Œë ˆì´ì–´ ì…ì¥ ì‹œ | í”Œë ˆì´ì–´ ì¶”ê°€, í˜¸ìŠ¤íŠ¸ ì§€ì •, íƒ€ì´ë¨¸ ì„¤ì • |
| `onLeave` | í”Œë ˆì´ì–´ í‡´ì¥ ì‹œ | í”Œë ˆì´ì–´ ì œê±°, í˜¸ìŠ¤íŠ¸ ìŠ¹ê³„, ìŠ¹ë¦¬ ì¡°ê±´ í™•ì¸ |
| `onDispose` | ë°© ì†Œë©¸ ì‹œ | íƒ€ì´ë¨¸ ì •ë¦¬, ë¦¬ì†ŒìŠ¤ í•´ì œ |

#### í•µì‹¬ ë©”ì„œë“œ

```typescript
// ê²Œì„ ì‹œì‘ - ë´‡ìœ¼ë¡œ íŒ€ ì±„ìš°ê¸°, ì´ˆê¸° ìœ„ì¹˜ ë°°ì¹˜, ê²Œì„ ë£¨í”„ ì‹œì‘
private startGame(): void

// ê²Œì„ ë£¨í”„ (60 FPS) - ë´‡ ì—…ë°ì´íŠ¸, ëˆˆë©ì´ ì—…ë°ì´íŠ¸, ì¶©ëŒ ê²€ì‚¬
private updateGame(): void

// ìŠ¹ë¦¬ ì¡°ê±´ í™•ì¸
private checkWinConditions(): void

// ì˜ì—­ í™•ì¸ (í”Œë ˆì´ì–´ê°€ ìê¸° ì˜ì—­ ë‚´ì— ìˆëŠ”ì§€)
private isInPlayerTerritory(x, y, team): boolean
```

### ë´‡ ì»¨íŠ¸ë¡¤ëŸ¬ (`src/server/bots/BotController.ts`)

ë´‡ í”Œë ˆì´ì–´ë¥¼ ê´€ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì…ë‹ˆë‹¤.

#### ì£¼ìš” ê¸°ëŠ¥

| ë©”ì„œë“œ | ì—­í•  |
|--------|------|
| `createBot(team)` | íŠ¹ì • íŒ€ì— ë´‡ ìƒì„± |
| `fillTeamsWithBots()` | ì–‘ íŒ€ì„ 3ëª…ì”© ë´‡ìœ¼ë¡œ ì±„ì›€ |
| `updateBots(currentTime)` | ë´‡ í–‰ë™ ì—…ë°ì´íŠ¸ (2ì´ˆë§ˆë‹¤ ëˆˆë©ì´ ë°œì‚¬) |
| `removeAllBots()` | ê²Œì„ ì¢…ë£Œ ì‹œ ëª¨ë“  ë´‡ ì œê±° |

#### ë´‡ íŠ¹ì„±

- **ë‹‰ë„¤ì„**: `[BOT] {ëœë¤ì´ë¦„}` í˜•ì‹
- **ì´ë™**: 1ì´ˆë§ˆë‹¤ ëœë¤ ë°©í–¥ìœ¼ë¡œ ì´ë™ (í”Œë ˆì´ì–´ì™€ ë™ì¼í•œ ì†ë„ 2)
- **ê³µê²©**: 2ì´ˆë§ˆë‹¤ ìƒëŒ€ ì§„ì˜ ë°©í–¥ìœ¼ë¡œ ëˆˆë©ì´ ë°œì‚¬ (ì¼ë°˜ ë°ë¯¸ì§€ 4)
- **í”¼ê²©**: ì¼ë°˜ í”Œë ˆì´ì–´ì™€ ë™ì¼

### ë‹‰ë„¤ì„ ìƒì„±ê¸° (`src/server/utils/NicknameGenerator.ts`)

ëœë¤ ë‹‰ë„¤ì„ì„ ìƒì„±í•˜ëŠ” ìœ í‹¸ë¦¬í‹°ì…ë‹ˆë‹¤.

```typescript
// í”Œë ˆì´ì–´ìš© ë‹‰ë„¤ì„ ìƒì„±: {í˜•ìš©ì‚¬}{ëª…ì‚¬}{ìˆ«ì}
generateNickname(): string  // ì˜ˆ: "BraveWolf42"

// ë´‡ìš© ë‹‰ë„¤ì„ ìƒì„±
generateBotNickname(): string  // ì˜ˆ: "SnowBot73"
```

### ìƒíƒœ ìŠ¤í‚¤ë§ˆ (`src/server/schema/`)

Colyseusì˜ `@colyseus/schema`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìë™ ë™ê¸°í™”ë˜ëŠ” ìƒíƒœë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

#### GameState (`GameState.ts`)

ê²Œì„ ì „ì²´ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ë£¨íŠ¸ ìŠ¤í‚¤ë§ˆì…ë‹ˆë‹¤.

```typescript
class GameState extends Schema {
  @type({ map: PlayerSchema }) players     // ëª¨ë“  í”Œë ˆì´ì–´
  @type({ map: SnowballSchema }) snowballs // í˜„ì¬ ëˆˆë©ì´ë“¤
  @type('string') phase                    // ê²Œì„ í˜ì´ì¦ˆ
  @type('string') winner                   // ìŠ¹ì
  @type('number') mapSize                  // ë§µ í¬ê¸° (800)
  @type('string') roomName                 // ë£¸ ì´ë¦„
  @type('number') botCount                 // í˜„ì¬ ë´‡ ìˆ˜
}
```

#### PlayerSchema (`PlayerSchema.ts`)

ê° í”Œë ˆì´ì–´ì˜ ìƒíƒœë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

```typescript
class PlayerSchema extends Schema {
  @type('string') sessionId   // ì„¸ì…˜ ID
  @type('string') nickname    // ë‹‰ë„¤ì„
  @type('string') googleId    // Google OAuth ID (ì„ íƒ)
  @type('string') photoUrl    // í”„ë¡œí•„ ì‚¬ì§„ URL (ì„ íƒ)
  @type('string') team        // íŒ€ ('red' | 'blue')
  @type('boolean') isReady    // ì¤€ë¹„ ìƒíƒœ
  @type('boolean') isHost     // í˜¸ìŠ¤íŠ¸ ì—¬ë¶€
  @type('boolean') isBot      // ë´‡ ì—¬ë¶€
  @type('number') x, y        // ìœ„ì¹˜
  @type('number') energy      // ì—ë„ˆì§€ (ì´ˆê¸°ê°’ 10)
  @type('boolean') isStunned  // ìŠ¤í„´ ìƒíƒœ
  @type('number') joinedAt    // ì…ì¥ ì‹œê°„
}
```

#### SnowballSchema (`SnowballSchema.ts`)

ëˆˆë©ì´(ë°œì‚¬ì²´)ì˜ ìƒíƒœë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

```typescript
class SnowballSchema extends Schema {
  @type('string') id          // ê³ ìœ  ID
  @type('string') ownerId     // ë°œì‚¬í•œ í”Œë ˆì´ì–´ ID
  @type('number') x, y        // í˜„ì¬ ìœ„ì¹˜
  @type('number') velocityX   // Xì¶• ì†ë„
  @type('number') velocityY   // Yì¶• ì†ë„
  @type('number') damage      // ë°ë¯¸ì§€ (4 ë˜ëŠ” 7)
  @type('string') team        // ë°œì‚¬í•œ íŒ€
}
```

---

## ê³µìœ  ìœ í‹¸ë¦¬í‹°

ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

### ì—ëŸ¬ ì²˜ë¦¬ (`src/shared/errors.ts`)

ê²Œì„ì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë¥¼ ì¼ê´€ë˜ê²Œ ì²˜ë¦¬í•©ë‹ˆë‹¤.

#### GameErrorCode

ì—ëŸ¬ ìœ í˜•ì„ ë¶„ë¥˜í•˜ëŠ” ì—´ê±°í˜•ì…ë‹ˆë‹¤.

| ì¹´í…Œê³ ë¦¬ | ì½”ë“œ | ì„¤ëª… |
|---------|------|------|
| Room (1xxx) | `ROOM_FULL`, `GAME_IN_PROGRESS`, `ROOM_NOT_FOUND` | ë£¸ ê´€ë ¨ ì—ëŸ¬ |
| Player (2xxx) | `INVALID_NICKNAME`, `NOT_READY`, `NO_TEAM_SELECTED`, `NOT_HOST` | í”Œë ˆì´ì–´ ê´€ë ¨ ì—ëŸ¬ |
| Team (3xxx) | `TEAM_FULL`, `INVALID_TEAM` | íŒ€ ê´€ë ¨ ì—ëŸ¬ |
| Game State (4xxx) | `INVALID_PHASE`, `PLAYER_STUNNED` | ê²Œì„ ìƒíƒœ ì—ëŸ¬ |
| Network (5xxx) | `CONNECTION_ERROR`, `TIMEOUT`, `RATE_LIMITED` | ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ |
| Validation (6xxx) | `INVALID_INPUT`, `VALIDATION_FAILED` | ê²€ì¦ ì—ëŸ¬ |
| Internal (9xxx) | `INTERNAL_ERROR`, `UNKNOWN_ERROR` | ë‚´ë¶€ ì—ëŸ¬ |

#### GameError í´ë˜ìŠ¤

```typescript
class GameError extends Error {
  code: GameErrorCode;     // ì—ëŸ¬ ì½”ë“œ
  statusCode: number;      // HTTP ìƒíƒœ ì½”ë“œ
  metadata?: Record<string, any>;  // ì¶”ê°€ ì •ë³´
  timestamp: number;       // ë°œìƒ ì‹œê°„
}
```

#### íŒ©í† ë¦¬ í•¨ìˆ˜

ìì£¼ ì‚¬ìš©ë˜ëŠ” ì—ëŸ¬ë¥¼ ì‰½ê²Œ ìƒì„±í•©ë‹ˆë‹¤.

```typescript
createRoomFullError()           // 403 - ë£¸ ì •ì› ì´ˆê³¼
createGameInProgressError()     // 403 - ê²Œì„ ì§„í–‰ ì¤‘
createTeamFullError(team)       // 403 - íŒ€ ì •ì› ì´ˆê³¼
createInvalidTeamError(team)    // 400 - ì˜ëª»ëœ íŒ€
createNotHostError()            // 403 - í˜¸ìŠ¤íŠ¸ ê¶Œí•œ í•„ìš”
createInvalidPhaseError(phase)  // 400 - ì˜ëª»ëœ í˜ì´ì¦ˆ
createPlayerStunnedError()      // 400 - ìŠ¤í„´ ìƒíƒœ
```

### ë¡œê¹… ìœ í‹¸ë¦¬í‹° (`src/shared/logger.ts`)

í™˜ê²½ì— ë§ëŠ” ë¡œê¹…ì„ ì œê³µí•©ë‹ˆë‹¤.

#### LogLevel

| ë ˆë²¨ | ê°’ | ì„¤ëª… |
|------|---|------|
| `DEBUG` | 0 | ë””ë²„ê·¸ ì •ë³´ |
| `INFO` | 1 | ì¼ë°˜ ì •ë³´ |
| `WARN` | 2 | ê²½ê³  |
| `ERROR` | 3 | ì—ëŸ¬ |

#### Logger í´ë˜ìŠ¤

```typescript
const logger = createLogger('GameRoom');

logger.debug('Player joined', { sessionId });  // ê°œë°œ í™˜ê²½ë§Œ
logger.info('Game started');                   // ì¼ë°˜ ë¡œê·¸
logger.warn('Player not ready');               // ê²½ê³ 
logger.error('Connection failed', error);      // ì—ëŸ¬ (ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ í¬í•¨)
```

- **Node.js**: DEBUG ë ˆë²¨ë¶€í„° ì¶œë ¥
- **ë¸Œë¼ìš°ì €**: INFO ë ˆë²¨ë¶€í„° ì¶œë ¥

### ë©”ì‹œì§€ íƒ€ì… (`src/shared/messages.ts`)

í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ê°„ ë©”ì‹œì§€ì˜ íƒ€ì…ì„ ì •ì˜í•©ë‹ˆë‹¤.

#### í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„

| ì¸í„°í˜ì´ìŠ¤ | ë©”ì‹œì§€ íƒ€ì… | í•„ë“œ |
|-----------|------------|------|
| `SetProfileMessage` | `setProfile` | nickname, googleId?, photoUrl? |
| `SelectTeamMessage` | `selectTeam` | team: 'red' \| 'blue' |
| `ReadyMessage` | `ready` | ready: boolean |
| `StartGameMessage` | `startGame` | (ì—†ìŒ) |
| `MoveMessage` | `move` | x: number, y: number |
| `ThrowSnowballMessage` | `throwSnowball` | chargeLevel: number |

#### ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸

| ì¸í„°í˜ì´ìŠ¤ | ë©”ì‹œì§€ íƒ€ì… | í•„ë“œ |
|-----------|------------|------|
| `GameEndedMessage` | `gameEnded` | winner: 'red' \| 'blue' \| 'draw' |
| `PlayerKickedMessage` | `playerKicked` | sessionId, reason |
| `ErrorMessage` | `error` | message, code?, metadata? |

#### íƒ€ì… ê°€ë“œ

ë©”ì‹œì§€ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.

```typescript
// ë©”ì‹œì§€ ìœ í˜• í™•ì¸
if (isSetProfileMessage(msg)) {
  // msg.nickname íƒ€ì… ì•ˆì „í•˜ê²Œ ì ‘ê·¼ ê°€ëŠ¥
}

if (isSelectTeamMessage(msg)) {
  // msg.teamì€ 'red' | 'blue'
}

if (isMoveMessage(msg)) {
  // msg.x, msg.yëŠ” number
}

if (isThrowSnowballMessage(msg)) {
  // msg.chargeLevelì€ number
}
```

---

## í´ë¼ì´ì–¸íŠ¸ ì•„í‚¤í…ì²˜

### ì§„ì…ì  (`src/client/index.ts`)

Phaser 3 ê²Œì„ ì„¤ì •ì„ ì •ì˜í•©ë‹ˆë‹¤.

```typescript
const config: Phaser.Types.Core.GameConfig = {
  type: Phaser.AUTO,
  width: 800,
  height: 800,
  parent: 'game-container',
  backgroundColor: '#1a1a2e',
  scene: [MainMenuScene, LobbyScene, GameScene],
  physics: {
    default: 'arcade',
    arcade: { gravity: { x: 0, y: 0 } }
  }
};

new Phaser.Game(config);
```

### ì„¤ì • (`src/client/config.ts`)

ì„œë²„ ì—°ê²° ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.

```typescript
const SERVER_URL = process.env.SERVER_URL || 'localhost:2567';

// í”„ë¡œí† ì½œ ìë™ ê°ì§€ (HTTPS í™˜ê²½ì—ì„œ WSS ì‚¬ìš©)
const isSecure = window.location.protocol === 'https:';
const wsProtocol = isSecure ? 'wss' : 'ws';
const httpProtocol = isSecure ? 'https' : 'http';

export const config = {
  serverUrl: SERVER_URL,
  wsUrl: `${wsProtocol}://${SERVER_URL}`,
  apiUrl: `${httpProtocol}://${SERVER_URL}`,
};
```

### ì—ì…‹ (`src/client/assets/`)

#### PixelCharacter.ts

í”½ì…€ ì•„íŠ¸ ìºë¦­í„° í…ìŠ¤ì²˜ì™€ ì• ë‹ˆë©”ì´ì…˜ì„ ìƒì„±í•©ë‹ˆë‹¤.

- íŒ€ë³„ ìºë¦­í„° í…ìŠ¤ì²˜ (red_idle, blue_idle, red_walk, blue_walk, red_stunned, blue_stunned)
- ëˆˆë©ì´ í…ìŠ¤ì²˜ (ì¼ë°˜, ì°¨ì§•)
- ë§Œì„¸ ì• ë‹ˆë©”ì´ì…˜ (cheer1, cheer2)
- ê±·ê¸° ì• ë‹ˆë©”ì´ì…˜ ì •ì˜

#### EnvironmentAssets.ts

ë§µ ì¥ì‹ìš© í”½ì…€ ì•„íŠ¸ ì—ì…‹ì„ ìƒì„±í•©ë‹ˆë‹¤.

| í•¨ìˆ˜ | ì—­í•  |
|------|------|
| `generateEnvironmentTextures()` | í™˜ê²½ ì¥ì‹ í…ìŠ¤ì²˜ ìƒì„± (ë‚˜ë¬´, ë°”ìœ„, ìˆ˜í’€) |
| `createEnvironmentDecorations()` | ê²Œì„ ë§µ í…Œë‘ë¦¬ ë° ëŒ€ê°ì„  ê²½ê³„ì— ì¥ì‹ ë°°ì¹˜ |
| `createMenuDecorations()` | ë©”ì¸ ë©”ë‰´ í…Œë‘ë¦¬ì— ë‚˜ë¬´ ì¥ì‹ ë°°ì¹˜ |

**ì—ì…‹ íƒ€ì…:**
- ë‚˜ë¬´: `tree_small` (24x32), `tree_tiny` (16x24)
- ë°”ìœ„: `rock_medium` (16x16), `rock_small` (12x12), `rock_tiny` (8x8)
- ìˆ˜í’€: `bush_medium` (16x12), `bush_small` (12x10)
- ê¸°íƒ€: `snow_rock` (10x8)

### MainMenuScene (`src/client/scenes/MainMenuScene.ts`)

ë©”ì¸ ë©”ë‰´ í™”ë©´ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

#### ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| ëœë¤ ë‹‰ë„¤ì„ | ì„œë²„ APIì—ì„œ ë‹‰ë„¤ì„ ìƒì„± (ì‹¤íŒ¨ ì‹œ "Player" + ëœë¤ ìˆ«ì), localStorageì— ì €ì¥ |
| ë‹‰ë„¤ì„ ë³€ê²½ | [Change] ë²„íŠ¼ìœ¼ë¡œ ìƒˆ ë‹‰ë„¤ì„ ìƒì„± ë° ì €ì¥ |
| ë²„ì „ í‘œì‹œ | í´ë¼ì´ì–¸íŠ¸ ë²„ì „(config.clientVersion) ë° ì„œë²„ ë²„ì „(GET /api/version)ì„ í™”ë©´ í•˜ë‹¨ì— í‘œì‹œ |
| ë£¸ ëª©ë¡ | 5ì´ˆë§ˆë‹¤ ìë™ ìƒˆë¡œê³ ì¹¨, [Refresh] ë²„íŠ¼ìœ¼ë¡œ ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ |
| Quick Play | `joinOrCreate`ë¡œ ë¹ ë¥¸ ì°¸ì—¬ |
| Create Room | ìƒˆ ë°© ìƒì„± (`{ë‹‰ë„¤ì„}'s Room` í˜•ì‹) |
| Join Room | ì„ íƒí•œ ë°©ì— ì°¸ì—¬ |

#### ì‹œê°ì  ìš”ì†Œ

| ìš”ì†Œ | ì„¸ë¶€ ì‚¬í•­ |
|------|----------|
| ë°°ê²½ìƒ‰ | `#e8f4f8` (ì—°í•œ ì²­ë¡ìƒ‰) |
| íƒ€ì´í‹€ | "SnowClash" (48px, ë³¼ë“œ, #333333) |
| **ì• ë‹ˆë©”ì´ì…˜ ìºë¦­í„°** | íƒ€ì´í‹€ ì–‘ì˜†ì— Red/Blue íŒ€ ìºë¦­í„° (scale 2x, ë°”ìš´ì‹± ì• ë‹ˆë©”ì´ì…˜ y: 35-40, 800ms yoyo, BlueëŠ” 400ms ë”œë ˆì´) |
| ë‹‰ë„¤ì„ í‘œì‹œ | 24px, ë³¼ë“œ, #008800 (ì´ˆë¡ìƒ‰) |
| Change ë²„íŠ¼ | 14px, íšŒìƒ‰ (#888888), í˜¸ë²„ ì‹œ #333333 |
| Quick Play ë²„íŠ¼ | 20px, ë…¹ìƒ‰ ë°°ê²½ (#4CAF50), í˜¸ë²„ ì‹œ #66BB6A |
| Create Room ë²„íŠ¼ | 20px, íŒŒë€ ë°°ê²½ (#2196F3), í˜¸ë²„ ì‹œ #42A5F5 |
| Refresh ë²„íŠ¼ | ìš°ì¸¡ ì •ë ¬ (x=560), 12px, íšŒìƒ‰, í˜¸ë²„ íš¨ê³¼ |
| ë£¸ ëª©ë¡ ì•„ì´í…œ | 560x38px, í° ë°°ê²½ (0.8 íˆ¬ëª…ë„), 8px ë‘¥ê·¼ ëª¨ì„œë¦¬, 1px íšŒìƒ‰ í…Œë‘ë¦¬ |
| í”Œë ˆì´ì–´ ìˆ˜ í‘œì‹œ | ë…¹ìƒ‰ (#008800) if not full, ë¹¨ê°• (#cc0000) if full |
| Join ë²„íŠ¼ | ì£¼í™©ìƒ‰ (#FF9800), í˜¸ë²„ ì‹œ #FFB74D |
| ë¹ˆ ë°© ë©”ì‹œì§€ | "No rooms available. Create one!" (íšŒìƒ‰) |
| **ë²„ì „ ì •ë³´** | í™”ë©´ í•˜ë‹¨ (y: MAP_SIZE - 20), 10px, íšŒìƒ‰ (#999999), í˜•ì‹: "Client: v{version} \| Server: v{version}" |

#### UI ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ğŸ”´ SnowClash ğŸ”µ                  â”‚  â† ì• ë‹ˆë©”ì´ì…˜ ìºë¦­í„°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Your Nickname: BraveWolf42      â”‚
â”‚            [Change]                  â”‚
â”‚                                      â”‚
â”‚   [Quick Play]    [Create Room]      â”‚
â”‚                                      â”‚
â”‚   Available Rooms         [Refresh]  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ Room Name     2/6    [Join]â”‚     â”‚  â† ì´ˆë¡ìƒ‰
â”‚   â”‚ Room Name     6/6    [Join]â”‚     â”‚  â† ë¹¨ê°„ìƒ‰ (full)
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                      â”‚
â”‚ Client: v1.1.0 | Server: v1.1.0      â”‚  â† ë²„ì „ ì •ë³´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ë°ì´í„° ì €ì¥

- **localStorage**: `snowclash_nickname` í‚¤ì— ë‹‰ë„¤ì„ ì €ì¥
- ì²« ë¡œë“œ ì‹œ localStorageì—ì„œ ë³µì›, ì—†ìœ¼ë©´ API í˜¸ì¶œ
- Change ë²„íŠ¼ í´ë¦­ ì‹œ APIì—ì„œ ìƒˆ ë‹‰ë„¤ì„ ë°›ì•„ ì €ì¥

### LobbyScene (`src/client/scenes/LobbyScene.ts`)

ê²Œì„ ì‹œì‘ ì „ ë¡œë¹„ í™”ë©´ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

#### ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| íŒ€ ì„ íƒ | Red/Blue ì˜ì—­ í´ë¦­ìœ¼ë¡œ íŒ€ ì„ íƒ (íŒ€ë‹¹ ìµœëŒ€ 3ëª…) |
| Ready ì‹œìŠ¤í…œ | ì¤€ë¹„ ìƒíƒœ í† ê¸€ (Ready â†” Not Ready) |
| í˜¸ìŠ¤íŠ¸ ê¶Œí•œ | ì²« ì…ì¥ìê°€ ê²Œì„ ì‹œì‘ ë²„íŠ¼ ì‚¬ìš© ê°€ëŠ¥ |
| í”Œë ˆì´ì–´ í‘œì‹œ | íŒ€ë³„ í”Œë ˆì´ì–´ í‘œì‹œ (ìºë¦­í„° ìŠ¤í”„ë¼ì´íŠ¸, ë‹‰ë„¤ì„, ìƒíƒœ í‘œì‹œ) |
| ë’¤ë¡œ ê°€ê¸° | MainMenuSceneìœ¼ë¡œ ë³µê·€ (ë°©ì—ì„œ í‡´ì¥) |

#### ì‹œê°ì  ìš”ì†Œ

| ìš”ì†Œ | ì„¸ë¶€ ì‚¬í•­ |
|------|----------|
| ë°°ê²½ìƒ‰ | `#e8f4f8` (ì—°í•œ ì²­ë¡ìƒ‰) |
| íƒ€ì´í‹€ | "Game Lobby" (24px, ë³¼ë“œ, ì¤‘ì•™) + ë°© ì´ë¦„ (14px, íšŒìƒ‰) |
| Back ë²„íŠ¼ | ì¢Œìƒë‹¨, íšŒìƒ‰, í˜¸ë²„ ì‹œ ê²€ì€ìƒ‰ |
| **ëŒ€ê°ì„  íŒ€ ì˜ì—­** | Red (ìš°ìƒë‹¨ ì‚¼ê°í˜•, 0.1 íˆ¬ëª…ë„), Blue (ì¢Œí•˜ë‹¨ ì‚¼ê°í˜•, 0.1 íˆ¬ëª…ë„) |
| ëŒ€ê°ì„  | (0,70)ì—ì„œ (800,730)ê¹Œì§€, í°ìƒ‰ 2px, 0.5 íˆ¬ëª…ë„ |
| íŒ€ ë¼ë²¨ | "RED" (640,200, 28px, 0.4 íˆ¬ëª…ë„), "BLUE" (160,600, 28px, 0.4 íˆ¬ëª…ë„) |
| ì•ˆë‚´ ë¬¸êµ¬ | "Click area to change team" (ì¤‘ì•™, 11px, ë°˜íˆ¬ëª… í° ë°°ê²½) |
| **í”Œë ˆì´ì–´ ìœ„ì¹˜** | ëŒ€ê°ì„ ì— í‰í–‰í•˜ê²Œ ë°°ì¹˜, 110px ê°„ê²© |
| í”Œë ˆì´ì–´ ìŠ¤í”„ë¼ì´íŠ¸ | íŒ€ ìƒ‰ìƒ, 1.2x í¬ê¸° |
| **í˜„ì¬ í”Œë ˆì´ì–´ í‘œì‹œ** | ë…¸ë€ìƒ‰ ë§ (3px, ë°˜ì§€ë¦„ 22) |
| **Ready í”Œë ˆì´ì–´ í‘œì‹œ** | ì´ˆë¡ìƒ‰ ë§ (2px, ë°˜ì§€ë¦„ 20), âœ“ ì•„ì´ì½˜, ë°”ìš´ì‹± ì• ë‹ˆë©”ì´ì…˜ (y: -5, 500ms yoyo) |
| **í˜¸ìŠ¤íŠ¸ í‘œì‹œ** | ğŸ‘‘ ì™•ê´€ ì•„ì´ì½˜ (16px, y: -50) |
| ë‹‰ë„¤ì„ | ìì‹ : ì£¼í™©ìƒ‰ (#cc8800), íƒ€ì¸: ê²€ì€ìƒ‰, 10px, ë°˜íˆ¬ëª… í° ë°°ê²½ |
| Ready ë²„íŠ¼ | ë…¹ìƒ‰ (#006600), Ready ìƒíƒœ ì‹œ ë°ì€ ë…¹ìƒ‰ (#00aa00) + ë³¼ë“œ, "Not Ready"ë¡œ í…ìŠ¤íŠ¸ ë³€ê²½ |
| Start ë²„íŠ¼ | ì£¼í™©ìƒ‰ (#ff8800), í˜¸ìŠ¤íŠ¸ë§Œ í‘œì‹œ |

#### UI ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  < Back        Game Lobby            â”‚
â”‚              Room Name               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   \                  â”‚  â† ëŒ€ê°ì„  ê²½ê³„
â”‚    RED ì˜ì—­         \   BLUE ì˜ì—­    â”‚
â”‚  (ë°˜íˆ¬ëª… ë¹¨ê°•)        \ (ë°˜íˆ¬ëª… íŒŒë‘) â”‚
â”‚                       \              â”‚
â”‚   "Click area to change team"        â”‚  â† ì¤‘ì•™ ì•ˆë‚´
â”‚                         \            â”‚
â”‚                           \          â”‚
â”‚                             \        â”‚
â”‚         ğŸ‘‘Player1 âœ“    Player2       â”‚  â† í”Œë ˆì´ì–´ ìŠ¤í”„ë¼ì´íŠ¸
â”‚                               \      â”‚     ëŒ€ê°ì„  í‰í–‰ ë°°ì¹˜
â”‚                                 \    â”‚
â”‚          [Ready]  [Start Game]       â”‚  â† í•˜ë‹¨ ë²„íŠ¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### í”Œë ˆì´ì–´ ë°°ì¹˜ ì•Œê³ ë¦¬ì¦˜

Red íŒ€ (ìš°ìƒë‹¨):
```
x = 320 + index * 80
y = 143 + index * 80
```

Blue íŒ€ (ì¢Œí•˜ë‹¨):
```
x = 120 + index * 80
y = 297 + index * 80
```

#### ìƒíƒœ ë™ê¸°í™”

- **100ms ì´ˆê¸° ë™ê¸°í™”**: ì”¬ ìƒì„± í›„ ê°•ì œ ë™ê¸°í™”ë¡œ í”Œë ˆì´ì–´ í‘œì‹œ ë³´ì¥
- **onStateChange**: ì „ì²´ ìƒíƒœ ë³€ê²½ ê°ì§€
- **players.onAdd/onRemove**: í”Œë ˆì´ì–´ ì…ì¥/í‡´ì¥ ê°ì§€
- **player.onChange**: ê°œë³„ í”Œë ˆì´ì–´ ìƒíƒœ ë³€ê²½ ê°ì§€ (íŒ€, Ready ìƒíƒœ ë“±)

### GameScene (`src/client/scenes/GameScene.ts`)

ì‹¤ì œ ê²Œì„ í”Œë ˆì´ í™”ë©´ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

#### ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| ë§µ ë Œë”ë§ | 600x600px, í° ë°°ê²½, ë°˜íˆ¬ëª… Red/Blue ì˜ì—­, ëŒ€ê°ì„  ì—†ìŒ (LobbySceneê³¼ ë‹¬ë¦¬) |
| í”Œë ˆì´ì–´ ë Œë”ë§ | í”½ì…€ ìºë¦­í„° ìŠ¤í”„ë¼ì´íŠ¸, ë‹‰ë„¤ì„, ì—ë„ˆì§€ ë°”, ì¸ë””ì¼€ì´í„° ë§ |
| ë´‡ ë Œë”ë§ | íšŒìƒ‰ ë°˜íˆ¬ëª… ë§ (1px, ë°˜ì§€ë¦„ 18, 0.5 íˆ¬ëª…ë„)ìœ¼ë¡œ êµ¬ë¶„ |
| ëˆˆë©ì´ ë Œë”ë§ | ì´ë™í•˜ëŠ” ë°œì‚¬ì²´ (ì¼ë°˜: 5px, ì°¨ì§•: 9px) |
| ì…ë ¥ ì²˜ë¦¬ | í‚¤ë³´ë“œ (WASD/Arrow) + ë§ˆìš°ìŠ¤/í„°ì¹˜ (í´ë¦­ìœ¼ë¡œ ì´ë™, í™€ë“œë¡œ ì°¨ì§•) |
| ëª¨ë°”ì¼ ì»¨íŠ¸ë¡¤ | ê°€ìƒ ì¡°ì´ìŠ¤í‹± (ì¢Œí•˜ë‹¨) + ê°€ìƒ ê³µê²© ë²„íŠ¼ (ìš°í•˜ë‹¨) |
| ì°¨ì§• ê²Œì´ì§€ | ì¢Œí•˜ë‹¨ (10, 560), 100x20px, ë…¸ë€ìƒ‰ â†’ ë¹¨ê°„ìƒ‰ (ë°ìŠ¤í¬í†±) / ê³µê²© ë²„íŠ¼ ì£¼ë³€ (ëª¨ë°”ì¼) |
| ì—ë„ˆì§€ ë°” | í”Œë ˆì´ì–´ ìœ„ (30x4px), ìƒ‰ìƒ ì½”ë”© (ì´ˆë¡ > 50%, ë…¸ë‘ > 25%, ë¹¨ê°• â‰¤ 25%) |
| ì¶©ëŒ íš¨ê³¼ | íŒŒí¸ íš¨ê³¼ (6ê°œ ì…ì, ë°©ì‚¬í˜• í™•ì‚°, 400ms í˜ì´ë“œì•„ì›ƒ) |
| ìŠ¹ë¦¬ ì¶•í•˜ | ì´ê¸´ íŒ€ì€ ì´ë™ ê°€ëŠ¥, cheer ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ |
| ê²Œì„ ì¢…ë£Œ | ê²°ê³¼ í‘œì‹œ, Return to Menu ë²„íŠ¼ìœ¼ë¡œ ë³µê·€ |

#### ì‹œìŠ¤í…œ êµ¬ì¡°

GameSceneì€ ëª¨ë“ˆí™”ëœ ì‹œìŠ¤í…œë“¤ì„ ì‚¬ìš©í•˜ì—¬ ê²Œì„ ë¡œì§ì„ êµ¬í˜„í•©ë‹ˆë‹¤:

| ì‹œìŠ¤í…œ | ì—­í•  |
|--------|------|
| **InputSystem** | í‚¤ë³´ë“œ, ë§ˆìš°ìŠ¤, í„°ì¹˜ ì…ë ¥ ì²˜ë¦¬ ë° ì°¨ì§• ê´€ë¦¬ |
| **PlayerRenderSystem** | í”Œë ˆì´ì–´ ìŠ¤í”„ë¼ì´íŠ¸ ë Œë”ë§, ì• ë‹ˆë©”ì´ì…˜, UI ìš”ì†Œ (ë‹‰ë„¤ì„, ì—ë„ˆì§€ ë°”) |
| **SnowballSystem** | ëˆˆë©ì´ ë Œë”ë§ ë° ì¶©ëŒ ì‹œ íŒŒí¸ íš¨ê³¼ |
| **VirtualControllerSystem** | ëª¨ë°”ì¼ ì „ìš© ê°€ìƒ ì¡°ì´ìŠ¤í‹± ë° ê³µê²© ë²„íŠ¼ (í„°ì¹˜ ë””ë°”ì´ìŠ¤ ìë™ ê°ì§€) |

#### ì…ë ¥ ë°”ì¸ë”©

| ì…ë ¥ | ë™ì‘ |
|------|------|
| W / â†‘ | ìœ„ë¡œ ì´ë™ |
| A / â† | ì™¼ìª½ìœ¼ë¡œ ì´ë™ |
| S / â†“ | ì•„ë˜ë¡œ ì´ë™ |
| D / â†’ | ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ |
| **ë§ˆìš°ìŠ¤/í„°ì¹˜ í´ë¦­** | í´ë¦­í•œ ìœ„ì¹˜ë¡œ ì´ë™ (360Â° ììœ  ë°©í–¥, ë°ìŠ¤í¬í†±) |
| **ê°€ìƒ ì¡°ì´ìŠ¤í‹±** | 360Â° ì•„ë‚ ë¡œê·¸ ì´ë™ ì œì–´ (ëª¨ë°”ì¼, ì¢Œí•˜ë‹¨) |
| Space (íƒ­) | ì¼ë°˜ ê³µê²© (ìµœì†Œ 0.2ì´ˆ ì°¨ì§• í•„ìš”) |
| Space (í™€ë“œ 0.7ì´ˆ+) | ì°¨ì§• ê³µê²© (7 ë°ë¯¸ì§€) |
| **ë§ˆìš°ìŠ¤/í„°ì¹˜ í™€ë“œ** | ì°¨ì§• (í‚¤ë³´ë“œì™€ ë™ì¼í•˜ê²Œ ì‘ë™, ë°ìŠ¤í¬í†±) |
| **ê°€ìƒ ê³µê²© ë²„íŠ¼** | ì°¨ì§• ê³µê²© (ëª¨ë°”ì¼, ìš°í•˜ë‹¨, ì‹œê°ì  ì°¨ì§• ê²Œì´ì§€ í¬í•¨) |

#### ì‹œê°ì  ìš”ì†Œ - Playing Phase

| ìš”ì†Œ | ì„¸ë¶€ ì‚¬í•­ |
|------|----------|
| ë°°ê²½ìƒ‰ | `#e8f4f8` (ì—°í•œ ì²­ë¡ìƒ‰) |
| ë§µ | 600x600px, í° ë°°ê²½ |
| Red ì˜ì—­ | ìš°ìƒë‹¨ ì‚¼ê°í˜•, 0.1 ë¹¨ê°• íˆ¬ëª…ë„ |
| Blue ì˜ì—­ | ì¢Œí•˜ë‹¨ ì‚¼ê°í˜•, 0.1 íŒŒë‘ íˆ¬ëª…ë„ |
| **í”Œë ˆì´ì–´ ì¸ë””ì¼€ì´í„°** | ìì‹ : ë…¸ë€ìƒ‰ ë§ (2px, ë°˜ì§€ë¦„ 20), ë´‡: íšŒìƒ‰ ë§ (1px, ë°˜ì§€ë¦„ 18, 0.5 íˆ¬ëª…ë„) |
| ë‹‰ë„¤ì„ ë¼ë²¨ | y: -30, 10px, ê²€ì€ìƒ‰, ë°˜íˆ¬ëª… í° ë°°ê²½ |
| **ì—ë„ˆì§€ ë°”** | y: -40, 30x4px, ê²€ì€ ë°°ê²½ + ìƒ‰ìƒ ì½”ë”© fill, ê²Œì„ ì¢…ë£Œ ì‹œ ìˆ¨ê¹€ |
| **ì°¨ì§• ê²Œì´ì§€** | ì¢Œí•˜ë‹¨ (10, 560), 100x20px, ê²€ì€ ë°°ê²½, ì°¨ì§• ë ˆë²¨ì— ë”°ë¼ ë…¸ë‘/ë¹¨ê°•, 2px ê²€ì€ í…Œë‘ë¦¬ |
| ëˆˆë©ì´ | ì¼ë°˜: 5px ë°˜ì§€ë¦„, ì°¨ì§•: 9px ë°˜ì§€ë¦„ |
| **íŒŒí¸ íš¨ê³¼** | ëˆˆë©ì´ ì œê±° ì‹œ 6ê°œ ì…ì, 2-4px, íŒ€ ìƒ‰ìƒ, 15-30px ë°©ì‚¬í˜• í™•ì‚°, 400ms í˜ì´ë“œ |

#### ì‹œê°ì  ìš”ì†Œ - Ended Phase

| ìš”ì†Œ | ì„¸ë¶€ ì‚¬í•­ |
|------|----------|
| ì˜¤ë²„ë ˆì´ | 20% ê²€ì€ìƒ‰ íˆ¬ëª…ë„, 600x600px ì „ì²´ |
| ìŠ¹ë¦¬/íŒ¨ë°° ë©”ì‹œì§€ | ì¤‘ì•™, 48px ë³¼ë“œ |
| - Win ë©”ì‹œì§€ | "You Win!", íŒ€ ìƒ‰ìƒ (ë¹¨ê°• #ff0000 / íŒŒë‘ #0000ff) |
| - Lose ë©”ì‹œì§€ | "You Lose!", íšŒìƒ‰ (#666666) |
| - Draw ë©”ì‹œì§€ | "Draw!", í°ìƒ‰ (#ffffff) |
| **Return to Menu ë²„íŠ¼** | 260x50px, ë…¹ìƒ‰ (#4CAF50), ë‘¥ê·¼ ëª¨ì„œë¦¬ 10px, í° í…Œë‘ë¦¬ 3px |
| ë²„íŠ¼ í˜¸ë²„ | ë°ì€ ë…¹ìƒ‰ (#66BB6A) |
| ë²„íŠ¼ í…ìŠ¤íŠ¸ | "Return to Menu", 24px, í°ìƒ‰, ë³¼ë“œ |
| **ìŠ¹ë¦¬ íŒ€ ì• ë‹ˆë©”ì´ì…˜** | cheer ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ (4 FPS, 2 í”„ë ˆì„ ë£¨í”„) |
| **ìŠ¹ë¦¬ íŒ€ ì´ë™** | ì´ê¸´ íŒ€ì€ ììœ ë¡­ê²Œ ì´ë™ ê°€ëŠ¥ (stunned ë¬´ì‹œ) |
| ì—ë„ˆì§€ ë°” | ê²Œì„ ì¢…ë£Œ ì‹œ ëª¨ë“  ì—ë„ˆì§€ ë°” ìˆ¨ê¹€ |

#### ì…ë ¥ ì²˜ë¦¬ ìƒì„¸

**í‚¤ë³´ë“œ ì´ë™**:
- 8ë°©í–¥ ì´ë™ (ëŒ€ê°ì„  ê°€ëŠ¥)
- ì •ê·œí™”ëœ ë°©í–¥ ë²¡í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡
- ì„œë²„ì—ì„œ ì´ë™ ê²€ì¦ (ì˜ì—­ ì²´í¬)

**í¬ì¸í„° ì´ë™**:
- í´ë¦­í•œ ìœ„ì¹˜ë¥¼ í–¥í•´ 360Â° ììœ  ë°©í–¥ ì´ë™
- ì •ê·œí™”ëœ ë°©í–¥ ë²¡í„° ê³„ì‚°: `(dx/distance, dy/distance)`
- ëª©í‘œ ì§€ì  5px ì´ë‚´ ë„ë‹¬ ì‹œ ì´ë™ ì¤‘ë‹¨
- í‚¤ë³´ë“œ ì…ë ¥ì´ ìš°ì„ ìˆœìœ„ (í¬ì¸í„° ëª©í‘œ ì·¨ì†Œ)

**ì°¨ì§• ì‹œìŠ¤í…œ**:
- ìµœì†Œ ì°¨ì§• ì‹œê°„: 200ms (MIN_CHARGE_TIME)
- ì™„ì „ ì°¨ì§•: 700ms (0.7ì´ˆ)
- ì¿¨ë‹¤ìš´: 1000ms (THROW_COOLDOWN)
- Space í‚¤ ë˜ëŠ” í¬ì¸í„° í™€ë“œë¡œ ì°¨ì§•
- ì°¨ì§• ì¤‘ ê²Œì´ì§€ í‘œì‹œ (ë…¸ë€ìƒ‰ â†’ ë¹¨ê°„ìƒ‰)

#### í´ë¼ì´ì–¸íŠ¸ ì˜ˆì¸¡ ë° ë³´ê°„

**ë¡œì»¬ í”Œë ˆì´ì–´ (Client-Side Prediction)**:
- ì…ë ¥ ì¦‰ì‹œ ë¡œì»¬ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
- ì„œë²„ì—ì„œ ê²€ì¦ í›„ ìˆ˜ì • (ì˜ì—­ ë²—ì–´ë‚¨ ë“±)
- ì°¨ì§• ê²Œì´ì§€ì™€ ì¸ë””ì¼€ì´í„° ë¡œì»¬ ê°±ì‹ 

**ì›ê²© í”Œë ˆì´ì–´ (Lerp Interpolation)**:
- `lastX`, `lastY` ì €ì¥
- ì„œë²„ ìœ„ì¹˜ì™€ ì„ í˜• ë³´ê°„ (lerp factor 0.3)
- ë¶€ë“œëŸ¬ìš´ ì´ë™ íš¨ê³¼

**ëˆˆë©ì´ (Server Authoritative)**:
- ì„œë²„ì—ì„œ ìœ„ì¹˜ ê³„ì‚°
- í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë²„ ìœ„ì¹˜ë¥¼ ì§ì ‘ ë Œë”ë§
- ì œê±° ì‹œ í˜ì´ë”© ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ (fadingSnowballs Setìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€)

#### ê²Œì„ ì¢…ë£Œ ì²˜ë¦¬

**ìŠ¹ë¦¬ íŒ€ (Winning Team)**:
- ììœ ë¡­ê²Œ ì´ë™ ê°€ëŠ¥ (stunned ë¬´ì‹œ)
- cheer ì• ë‹ˆë©”ì´ì…˜ ìë™ ì¬ìƒ
- ì…ë ¥ ê³„ì† ì²˜ë¦¬ (ì´ë™ë§Œ ê°€ëŠ¥, ê³µê²© ë¶ˆê°€)

**íŒ¨ë°° íŒ€ (Losing Team)**:
- ëª¨ë“  ì…ë ¥ ì°¨ë‹¨
- stunned ìƒíƒœ ìœ ì§€
- ì—ë„ˆì§€ ë°” ìˆ¨ê¹€

**ê³µí†µ**:
- ì—ë„ˆì§€ ë°” ë Œë”ë§ ì¤‘ë‹¨
- ì˜¤ë²„ë ˆì´ ë° ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ
- Return to Menu ë²„íŠ¼ í‘œì‹œ

---

## ì¢Œí‘œ ë³€í™˜ ì‹œìŠ¤í…œ

SnowClashëŠ” **íŒ€ë³„ ì‹œì  íšŒì „(Team-specific Perspective Rotation)** ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ê° íŒ€ì´ ìì‹ ì˜ ì§„ì˜ì„ í™”ë©´ í•˜ë‹¨ì—ì„œ ë³´ë„ë¡ í•©ë‹ˆë‹¤.

### ê¸°ë³¸ ì›ë¦¬

| íŒ€ | ì‹œì  | ì¢Œí‘œ ë³€í™˜ |
|----|------|----------|
| **BlueíŒ€** | ê¸°ë³¸ ì‹œì  (0Â°) | ë³€í™˜ ì—†ìŒ `(x, y)` |
| **RedíŒ€** | 180Â° íšŒì „ ì‹œì  | ëŒ€ì¹­ ë³€í™˜ `(MAP_SIZE - x, MAP_SIZE - y)` |

**íš¨ê³¼**: Red íŒ€ í”Œë ˆì´ì–´ëŠ” ë§µì´ 180ë„ íšŒì „ë˜ì–´ ë³´ì´ë¯€ë¡œ, ìì‹ ì˜ ì§„ì˜(ì„œë²„ ì¢Œí‘œìƒ ìš°ìƒë‹¨)ì´ í™”ë©´ í•˜ë‹¨ì— í‘œì‹œë©ë‹ˆë‹¤.

### ë³€í™˜ ë©”ì„œë“œ

ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ ì”¬ê³¼ ì‹œìŠ¤í…œì€ ë‹¤ìŒ ë‘ ë©”ì„œë“œë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤:

```typescript
// ì„œë²„ ì¢Œí‘œ â†’ í™”ë©´ ì¢Œí‘œ (ë Œë”ë§ìš©)
private toViewCoords(x: number, y: number): { x: number; y: number } {
  if (this.myTeam === 'red') {
    return { x: MAP_SIZE - x, y: MAP_SIZE - y };
  }
  return { x, y };
}

// í™”ë©´ ì¢Œí‘œ â†’ ì„œë²„ ì¢Œí‘œ (ì…ë ¥ ì „ì†¡ìš©)
private toServerCoords(x: number, y: number): { x: number; y: number } {
  if (this.myTeam === 'red') {
    return { x: MAP_SIZE - x, y: MAP_SIZE - y };
  }
  return { x, y };
}
```

### êµ¬í˜„ ìœ„ì¹˜

| ì»´í¬ë„ŒíŠ¸ | ë©”ì„œë“œ | ìš©ë„ |
|---------|--------|------|
| **GameScene** | `toViewCoords`, `toServerCoords` | ë Œë”ë§ ë° í´ë¼ì´ì–¸íŠ¸ ì˜ˆì¸¡ |
| **InputSystem** | `toServerCoords` | í¬ì¸í„°/í„°ì¹˜ ì…ë ¥ ë³€í™˜, í‚¤ë³´ë“œ ë°©í–¥ ë°˜ì „ |
| **PlayerRenderSystem** | `toViewCoords` | í”Œë ˆì´ì–´ ìŠ¤í”„ë¼ì´íŠ¸ ìœ„ì¹˜ ë³€í™˜ |
| **SnowballSystem** | `toViewCoords` | ëˆˆë©ì´ ë° íŒŒí¸ íš¨ê³¼ ìœ„ì¹˜ ë³€í™˜ |
| **LobbyScene** | `toViewCoords`, `toServerCoords` | íŒ€ ì„ íƒ ë° ë¡œë¹„ í”Œë ˆì´ì–´ ë°°ì¹˜ |

### ë°ì´í„° íë¦„

```
ì…ë ¥ íë¦„ (í™”ë©´ â†’ ì„œë²„):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í”Œë ˆì´ì–´ ì…ë ¥            â”‚
â”‚ (í™”ë©´ ì¢Œí‘œ)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ toServerCoords()   â”‚ â† InputSystemì´ ì ìš©
    â”‚ (redë©´ 180Â° íšŒì „)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ì„œë²„ ì¢Œí‘œ           â”‚
    â”‚ (ì„œë²„ë¡œ ì „ì†¡)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë Œë”ë§ íë¦„ (ì„œë²„ â†’ í™”ë©´):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì„œë²„ ìƒíƒœ                â”‚
â”‚ (ì„œë²„ ì¢Œí‘œ)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ toViewCoords()     â”‚ â† ë Œë” ì‹œìŠ¤í…œë“¤ì´ ì ìš©
    â”‚ (redë©´ 180Â° íšŒì „)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ í™”ë©´ì— í‘œì‹œ         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì£¼ìš” ì ìš© ì‚¬ë¡€

**1. InputSystem (ì…ë ¥ ì²˜ë¦¬)**
- í¬ì¸í„° í´ë¦­: `toServerCoords(pointer.x, pointer.y)` â†’ ì„œë²„ ì¢Œí‘œë¡œ ë³€í™˜
- í‚¤ë³´ë“œ ì…ë ¥: Red íŒ€ì€ ë°©í–¥ ë°˜ì „ (`moveX = -input.moveX`)

**2. PlayerRenderSystem (í”Œë ˆì´ì–´ ë Œë”ë§)**
- í”Œë ˆì´ì–´ ìŠ¤í”„ë¼ì´íŠ¸ ìœ„ì¹˜: `toViewCoords(player.x, player.y)`
- ë‹‰ë„¤ì„, ì—ë„ˆì§€ ë°” ìœ„ì¹˜ë„ í•¨ê»˜ ë³€í™˜

**3. SnowballSystem (ëˆˆë©ì´ ë Œë”ë§)**
- ëˆˆë©ì´ ìœ„ì¹˜: `toViewCoords(snowball.x, snowball.y)`
- ì¶©ëŒ íš¨ê³¼ íŒŒí¸: `toViewCoords(snowball.x, snowball.y)`

**4. LobbyScene (ë¡œë¹„)**
- íŒ€ ì„ íƒ í´ë¦­: `toServerCoords(click.x, click.y)` â†’ ì–´ëŠ íŒ€ ì˜ì—­ì¸ì§€ íŒë‹¨
- í”Œë ˆì´ì–´ ì•„ë°”íƒ€ ë°°ì¹˜: `toViewCoords(lobbyPos.x, lobbyPos.y)`

### ì¥ì 

1. **ì§ê´€ì ì¸ í”Œë ˆì´**: ëª¨ë“  í”Œë ˆì´ì–´ê°€ ìì‹ ì˜ ì§„ì˜ì„ í™”ë©´ í•˜ë‹¨ì—ì„œ ë³¼ ìˆ˜ ìˆìŒ
2. **ê³µì •ì„±**: ì–‘ íŒ€ ëª¨ë‘ ë™ì¼í•œ ì‹œì  ê²½í—˜
3. **ë‹¨ìˆœí•œ ì„œë²„ ë¡œì§**: ì„œë²„ëŠ” í•˜ë‚˜ì˜ ì¢Œí‘œê³„ë§Œ ê´€ë¦¬
4. **ëŒ€ì¹­ì  ë³€í™˜**: `toViewCoords`ì™€ `toServerCoords`ê°€ ë™ì¼í•œ ê³µì‹ ì‚¬ìš© (ì—­ë³€í™˜ = ì •ë³€í™˜)

---

## ë°ì´í„° íë¦„

### ìƒíƒœ ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜

ColyseusëŠ” `@colyseus/schema`ë¥¼ í†µí•´ ì„œë²„ ìƒíƒœë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ìë™ìœ¼ë¡œ ë™ê¸°í™”í•©ë‹ˆë‹¤.

```
ì„œë²„                                í´ë¼ì´ì–¸íŠ¸
  â”‚                                    â”‚
  â”‚  GameState ë³€ê²½                     â”‚
  â”‚  (player.x = 100)                  â”‚
  â”‚                                    â”‚
  â”œâ”€â”€â”€â”€ ìë™ ë™ê¸°í™” (delta patch) â”€â”€â”€â”€â”€â†’â”‚
  â”‚                                    â”‚
  â”‚                        player.onChange() ì½œë°±
  â”‚                        â””â”€â”€ ë Œë”ë§ ì—…ë°ì´íŠ¸
```

### í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ë¦¬ìŠ¤ë„ˆ

```typescript
// ìƒíƒœ ë³€ê²½ ì‹œ ë¦¬ìŠ¤ë„ˆ ì„¤ì • (deferred pattern)
room.onStateChange((state) => {
  if (!listenersSetup && state.players?.onAdd) {
    listenersSetup = true;

    state.players.onAdd((player, sessionId) => {
      createPlayerGraphics(sessionId, player);
      player.onChange(() => updatePlayerGraphics(sessionId, player));
    });

    state.players.onRemove((player, sessionId) => {
      removePlayerGraphics(sessionId);
    });
  }
});
```

### ê²Œì„ íë¦„

```
MainMenuScene
â”œâ”€â”€ GET /api/nickname â†’ ëœë¤ ë‹‰ë„¤ì„
â”œâ”€â”€ GET /api/rooms â†’ ë£¸ ëª©ë¡ ì¡°íšŒ
â”œâ”€â”€ [Quick Play] â†’ joinOrCreate â†’ LobbyScene
â”œâ”€â”€ [Create Room] â†’ create â†’ LobbyScene
â””â”€â”€ [Join] â†’ joinById â†’ LobbyScene

LobbyScene
â”œâ”€â”€ selectTeam â†’ íŒ€ ì„ íƒ
â”œâ”€â”€ ready â†’ ì¤€ë¹„ ìƒíƒœ í† ê¸€
â”œâ”€â”€ [Start Game] â†’ startGame â†’ ë´‡ìœ¼ë¡œ ì±„ì›Œì„œ ì‹œì‘
â””â”€â”€ [Back] â†’ leave â†’ MainMenuScene

GameScene
â”œâ”€â”€ move â†’ ì´ë™
â”œâ”€â”€ throwSnowball â†’ ëˆˆë©ì´ ë°œì‚¬
â”œâ”€â”€ gameEnded ë©”ì‹œì§€ â†’ ê²°ê³¼ í‘œì‹œ
â””â”€â”€ 5ì´ˆ í›„ â†’ MainMenuScene
```

---

## ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
SnowClash/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ shared/                      # ê³µìœ  ì½”ë“œ (ì„œë²„/í´ë¼ì´ì–¸íŠ¸ ê³µí†µ)
â”‚   â”‚   â”œâ”€â”€ constants.ts             # ê²Œì„ ìƒìˆ˜ (MAP_SIZE, PLAYER_SPEED, etc.)
â”‚   â”‚   â”œâ”€â”€ errors.ts                # ì—ëŸ¬ ì½”ë“œ ë° GameError í´ë˜ìŠ¤
â”‚   â”‚   â”œâ”€â”€ logger.ts                # ë¡œê¹… ìœ í‹¸ë¦¬í‹° (Logger í´ë˜ìŠ¤)
â”‚   â”‚   â””â”€â”€ messages.ts              # ë©”ì‹œì§€ ì¸í„°í˜ì´ìŠ¤ ë° íƒ€ì… ê°€ë“œ
â”‚   â”‚
â”‚   â”œâ”€â”€ client/                      # í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ
â”‚   â”‚   â”œâ”€â”€ index.ts                 # Phaser ê²Œì„ ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ config.ts                # ì„œë²„ ì—°ê²° ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ index.html               # HTML í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”‚   â”œâ”€â”€ PixelCharacter.ts    # í”½ì…€ ì•„íŠ¸ ìºë¦­í„° ìƒì„±
â”‚   â”‚   â”‚   â””â”€â”€ EnvironmentAssets.ts # í™˜ê²½ ì¥ì‹ (ë‚˜ë¬´, ë°”ìœ„, ìˆ˜í’€)
â”‚   â”‚   â”œâ”€â”€ systems/                 # ê²Œì„ ì‹œìŠ¤í…œ ëª¨ë“ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ InputSystem.ts       # ì…ë ¥ ì²˜ë¦¬ (í‚¤ë³´ë“œ, ë§ˆìš°ìŠ¤, í„°ì¹˜, ì°¨ì§•)
â”‚   â”‚   â”‚   â”œâ”€â”€ PlayerRenderSystem.ts # í”Œë ˆì´ì–´ ë Œë”ë§ ë° ì• ë‹ˆë©”ì´ì…˜
â”‚   â”‚   â”‚   â”œâ”€â”€ SnowballSystem.ts    # ëˆˆë©ì´ ë Œë”ë§ ë° íŒŒí¸ íš¨ê³¼
â”‚   â”‚   â”‚   â””â”€â”€ VirtualControllerSystem.ts # ëª¨ë°”ì¼ ê°€ìƒ ì»¨íŠ¸ë¡¤ëŸ¬ (ì¡°ì´ìŠ¤í‹±, ê³µê²© ë²„íŠ¼)
â”‚   â”‚   â””â”€â”€ scenes/
â”‚   â”‚       â”œâ”€â”€ MainMenuScene.ts     # ë©”ì¸ ë©”ë‰´ ì”¬
â”‚   â”‚       â”œâ”€â”€ LobbyScene.ts        # ë¡œë¹„ ì”¬
â”‚   â”‚       â””â”€â”€ GameScene.ts         # ê²Œì„ ì”¬
â”‚   â”‚
â”‚   â””â”€â”€ server/                      # ì„œë²„ ì½”ë“œ
â”‚       â”œâ”€â”€ index.ts                 # Express + Colyseus ì„¤ì •
â”‚       â”œâ”€â”€ rooms/
â”‚       â”‚   â”œâ”€â”€ GameRoom.ts          # ê²Œì„ ë£¸ (í•µì‹¬ ë¡œì§)
â”‚       â”‚   â””â”€â”€ GameRoom.test.ts     # ê²Œì„ ë£¸ í…ŒìŠ¤íŠ¸
â”‚       â”œâ”€â”€ schema/
â”‚       â”‚   â”œâ”€â”€ GameState.ts         # ë£¨íŠ¸ ìƒíƒœ ìŠ¤í‚¤ë§ˆ
â”‚       â”‚   â”œâ”€â”€ PlayerSchema.ts      # í”Œë ˆì´ì–´ ìŠ¤í‚¤ë§ˆ
â”‚       â”‚   â””â”€â”€ SnowballSchema.ts    # ëˆˆë©ì´ ìŠ¤í‚¤ë§ˆ
â”‚       â”œâ”€â”€ bots/
â”‚       â”‚   â”œâ”€â”€ BotController.ts     # ë´‡ ì»¨íŠ¸ë¡¤ëŸ¬
â”‚       â”‚   â””â”€â”€ BotController.test.ts # ë´‡ ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸
â”‚       â””â”€â”€ utils/
â”‚           â”œâ”€â”€ NicknameGenerator.ts # ë‹‰ë„¤ì„ ìƒì„± ìœ í‹¸ë¦¬í‹°
â”‚           â””â”€â”€ NicknameGenerator.test.ts # ë‹‰ë„¤ì„ ìƒì„± í…ŒìŠ¤íŠ¸
â”‚
â”œâ”€â”€ public/                          # ì •ì  íŒŒì¼ (ë¹Œë“œ ê²°ê³¼ë¬¼)
â”‚   â”œâ”€â”€ bundle.js                    # í´ë¼ì´ì–¸íŠ¸ ë²ˆë“¤
â”‚   â””â”€â”€ index.html                   # ê²Œì„ HTML
â”‚
â”œâ”€â”€ dist/                            # ì„œë²„ ë¹Œë“œ ê²°ê³¼ë¬¼
â”‚   â””â”€â”€ server/
â”‚
â”œâ”€â”€ docs/                            # ë¬¸ì„œ
â”‚   â”œâ”€â”€ ARCHITECTURE.md              # ì•„í‚¤í…ì²˜ ê°€ì´ë“œ (ì´ ë¬¸ì„œ)
â”‚   â”œâ”€â”€ API.md                       # API ë ˆí¼ëŸ°ìŠ¤
â”‚   â”œâ”€â”€ GAME_MECHANICS.md            # ê²Œì„ ë©”ì¹´ë‹‰
â”‚   â”œâ”€â”€ CONTRIBUTING.md              # ê¸°ì—¬ ê°€ì´ë“œ
â”‚   â”œâ”€â”€ DEPLOYMENT.md                # ë°°í¬ ê°€ì´ë“œ
â”‚   â””â”€â”€ GOOGLE_OAUTH_SETUP.md        # OAuth ì„¤ì • ê°€ì´ë“œ (ì„ íƒ)
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ release.yml              # ë¦´ë¦¬ìŠ¤ ìë™í™” (GitHub Pages + Docker)
â”‚
â”œâ”€â”€ package.json                     # ì˜ì¡´ì„± ë° ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ tsconfig.json                    # TypeScript ì„¤ì • (ì„œë²„ìš©)
â”œâ”€â”€ tsconfig.client.json             # TypeScript ì„¤ì • (í´ë¼ì´ì–¸íŠ¸ìš©)
â”œâ”€â”€ webpack.config.js                # Webpack ì„¤ì • (í´ë¼ì´ì–¸íŠ¸ìš©)
â”œâ”€â”€ Dockerfile                       # ë„ì»¤ ë¹Œë“œ ì„¤ì •
â”œâ”€â”€ .env.example                     # í™˜ê²½ë³€ìˆ˜ ì˜ˆì‹œ (ê°œë°œìš©)
â”œâ”€â”€ .env.production.example          # í™˜ê²½ë³€ìˆ˜ ì˜ˆì‹œ (í”„ë¡œë•ì…˜ìš©)
â”œâ”€â”€ README.md                        # í”„ë¡œì íŠ¸ ì†Œê°œ
â””â”€â”€ CLAUDE.md                        # Claude Code ê°€ì´ë“œ
```

---

## ë¹Œë“œ êµ¬ì„±

### ì„œë²„ ë¹Œë“œ

TypeScript ì»´íŒŒì¼ëŸ¬(`tsc`)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```bash
npm run build:server  # dist/server/ì— ì¶œë ¥
```

`tsconfig.json` ì„¤ì •:
- `include`: `src/server/**/*` (ì„œë²„ ì½”ë“œë§Œ)
- `target`: ES2020
- `module`: CommonJS
- `experimentalDecorators`: true (Colyseus ìŠ¤í‚¤ë§ˆìš©)

### í´ë¼ì´ì–¸íŠ¸ ë¹Œë“œ

Webpackì„ ì‚¬ìš©í•˜ì—¬ ë²ˆë“¤ë§í•©ë‹ˆë‹¤.

```bash
npm run build  # public/bundle.jsì— ì¶œë ¥
```

`webpack.config.js` ì„¤ì •:
- ì§„ì…ì : `src/client/index.ts`
- ì¶œë ¥: `public/bundle.js`
- ë¡œë”: `ts-loader` (`tsconfig.client.json` ì‚¬ìš©)
- ê°œë°œ ì„œë²„ í¬íŠ¸: 8080

`tsconfig.client.json` ì„¤ì •:
- `target`: ES2020
- `module`: ES2020
- `lib`: ES2020, DOM (ë¸Œë¼ìš°ì € API ì§€ì›)
- `include`: `src/client/**/*`


---

## ê´€ë ¨ ë¬¸ì„œ

- **[API Reference](./API.md)** - REST API ë° WebSocket ë©”ì‹œì§€ í”„ë¡œí† ì½œ
- **[Game Mechanics](./GAME_MECHANICS.md)** - ê²Œì„ ë¡œì§ ë° ê·œì¹™ ìƒì„¸
- **[Testing Guide](./TESTING.md)** - í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ì»¤ë²„ë¦¬ì§€
- **[Deployment Guide](./DEPLOYMENT.md)** - í”„ë¡œë•ì…˜ ë°°í¬ ê°€ì´ë“œ

## ë„¤ë¹„ê²Œì´ì…˜

- [â† ë¬¸ì„œ ì¸ë±ìŠ¤ë¡œ ëŒì•„ê°€ê¸°](./README.md)
- [â† ë©”ì¸ READMEë¡œ ëŒì•„ê°€ê¸°](../README.md)
